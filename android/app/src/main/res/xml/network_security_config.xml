<?xml version="1.0" encoding="utf-8"?>
<!--
   Network security configuration for TorChat.

   All network traffic MUST go through Tor. This config:
   - Disables cleartext traffic to prevent accidental leaks
   - Only allows connections to localhost (for Tor SOCKS proxy)
   - Does not trust user-installed CAs (we use Tor, not HTTPS)
-->
<network-security-config>
    <!-- Default: No cleartext allowed anywhere -->
    <base-config cleartextTrafficPermitted="false">
        <trust-anchors>
            <!-- Only trust system CAs (not user-installed) -->
            <certificates src="system" />
        </trust-anchors>
    </base-config>

    <!-- Allow cleartext to localhost for Tor SOCKS proxy -->
    <domain-config cleartextTrafficPermitted="true">
        <domain includeSubdomains="false">localhost</domain>
        <domain includeSubdomains="false">127.0.0.1</domain>
    </domain-config>

    <!-- Allow .onion domains (Tor hidden services) -->
    <domain-config cleartextTrafficPermitted="true">
        <domain includeSubdomains="true">onion</domain>
    </domain-config>
</network-security-config>
